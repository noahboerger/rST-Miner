<div
    (fileDropped)="readMinerSettingsFile($event)"
    appDragDropFileUpload
    class="drag-and-drop-div">
    <p>
        <mat-toolbar matDialogTitle>
            <mat-icon class="more-space">settings</mat-icon>
            <span>rST-Miner Settings</span>
            <span class="spacer"></span>
            <button
                (click)="downloadMinerSettingsJsonFile()"
                class="download-settings-button"
                mat-icon-button>
                <mat-icon>download</mat-icon>
            </button>
        </mat-toolbar>
    </p>

    <mat-dialog-content class="mat-typography">
        <div class="down-space">
            <mat-accordion>
                <mat-expansion-panel>
                    <mat-expansion-panel-header>
                        <mat-panel-title>
                            Process Model Characteristics
                        </mat-panel-title>
                    </mat-expansion-panel-header>
                    <p>Workflow Net</p>
                    <p>Edge Weights</p>
                </mat-expansion-panel>

                <mat-expansion-panel>
                    <mat-expansion-panel-header>
                        <mat-panel-title>
                            Process Model Optimizations
                        </mat-panel-title>
                    </mat-expansion-panel-header>
                    <p>Noise Reduction</p>
                    <p>Implicit Place Removal</p>
                </mat-expansion-panel>

                <mat-expansion-panel>
                    <mat-expansion-panel-header>
                        <mat-panel-title>
                            Initialization Phase
                        </mat-panel-title>
                    </mat-expansion-panel-header>
                    <p><b>Concurrency Oracle</b></p>
                    <mat-radio-group
                        [(ngModel)]="actConcurrencyOracleSimpleName">
                        <div class="full-width" style="float: left">
                            <span
                                *ngFor="
                                    let concurrencyOracleTypeSimpleName of MinerSettings.concurrencyOracleTypesSimpleNames
                                ">
                                <mat-radio-button
                                    value="{{
                                        concurrencyOracleTypeSimpleName
                                    }}"
                                    >{{
                                        concurrencyOracleTypeSimpleName
                                    }}</mat-radio-button
                                >

                                <div
                                    *ngIf="
                                        rstMinerDataService.minerSettings.concurrencyOracle.getSimpleName() ===
                                            concurrencyOracleTypeSimpleName &&
                                        rstMinerDataService.minerSettings.concurrencyOracle.getSimpleName() !==
                                            NoneOracle.SIMPLE_NAME
                                    "
                                    [ngSwitch]="
                                        concurrencyOracleTypeSimpleName
                                    ">
                                    <span
                                        *ngSwitchCase="AlphaOracle.SIMPLE_NAME">
                                        <mat-form-field
                                            appearance="fill"
                                            class="full-width">
                                            <mat-label
                                                >Look Ahead Distance</mat-label
                                            >
                                            <input
                                                [(ngModel)]="
                                                    alphaOracleLookAheadDistance
                                                "
                                                matInput
                                                min="0"
                                                placeholder="Default {{
                                                    AlphaOracle.DEFAULT_LOOK_AHEAD_DISTANCE
                                                }}"
                                                type="number" />
                                        </mat-form-field>
                                        <br />
                                        <mat-checkbox
                                            [(ngModel)]="
                                                concurrencyOracleDistinguishSameEvents
                                            ">
                                            Distinguish same Events
                                        </mat-checkbox>
                                    </span>

                                    <span
                                        *ngSwitchCase="
                                            TimestampOracle.SIMPLE_NAME
                                        ">
                                        <mat-checkbox
                                            [(ngModel)]="
                                                concurrencyOracleDistinguishSameEvents
                                            ">
                                            Distinguish same Events
                                        </mat-checkbox>
                                    </span>
                                </div>
                                <br />
                            </span>
                        </div>
                    </mat-radio-group>
                    <p><b>Eventlog Transformation to Partial Orders</b></p>
                    <mat-checkbox
                        [(ngModel)]="
                            rstMinerDataService.minerSettings
                                .partialOrderTransformation.cleanLifecycle
                        ">
                        Clean Lifecycle Events
                    </mat-checkbox>
                    <br />
                    <mat-checkbox
                        [(ngModel)]="
                            rstMinerDataService.minerSettings
                                .partialOrderTransformation.addStartStopEvent
                        ">
                        Add Start and Stop Event
                    </mat-checkbox>
                    <br />
                    <mat-checkbox
                        [(ngModel)]="
                            rstMinerDataService.minerSettings
                                .partialOrderTransformation.discardPrefixes
                        ">
                        Discard prefixes
                    </mat-checkbox>
                </mat-expansion-panel>

                <mat-expansion-panel>
                    <mat-expansion-panel-header>
                        <mat-panel-title>
                            Random Place Generator
                        </mat-panel-title>
                    </mat-expansion-panel-header>
                    <mat-radio-group
                        [(ngModel)]="actRandomPlaceGeneratorSimpleName">
                        <div class="full-width" style="float: left">
                            <span
                                *ngFor="
                                    let randomPlaceGeneratorTypeSimpleName of MinerSettings.randomPlaceGeneratorTypesSimpleNames
                                ">
                                <mat-radio-button
                                    value="{{
                                        randomPlaceGeneratorTypeSimpleName
                                    }}"
                                    >{{
                                        randomPlaceGeneratorTypeSimpleName
                                    }}</mat-radio-button
                                >

                                <div
                                    *ngIf="
                                        rstMinerDataService.minerSettings.randomPlaceGenerator.getSimpleName() ===
                                        randomPlaceGeneratorTypeSimpleName
                                    "
                                    [ngSwitch]="
                                        randomPlaceGeneratorTypeSimpleName
                                    ">
                                    <span
                                        *ngSwitchCase="
                                            PrimitiveGenerator.SIMPLE_NAME
                                        ">
                                        <mat-form-field
                                            appearance="fill"
                                            class="full-width">
                                            <mat-label>Probability</mat-label>
                                            <input
                                                matInput
                                                min="0"
                                                max="1"
                                                placeholder="Default {{
                                                    PrimitiveGenerator.DEFAULT_PROBABILITY
                                                }}"
                                                type="number"
                                                [(ngModel)]="
                                                    primitiveGeneratorProbability
                                                " />
                                        </mat-form-field>
                                    </span>
                                </div>
                                <br />
                            </span>
                        </div>
                    </mat-radio-group>
                </mat-expansion-panel>

                <mat-expansion-panel>
                    <mat-expansion-panel-header>
                        <mat-panel-title>
                            Termination Condition
                        </mat-panel-title>
                    </mat-expansion-panel-header>
                    <mat-radio-group
                        [(ngModel)]="actTerminationConditionSimpleName">
                        <div class="full-width" style="float: left">
                            <span
                                *ngFor="
                                    let terminationTypeSimpleName of MinerSettings.terminationTypesSimpleNames
                                ">
                                <mat-radio-button
                                    value="{{ terminationTypeSimpleName }}"
                                    >{{
                                        terminationTypeSimpleName
                                    }}</mat-radio-button
                                >

                                <div
                                    *ngIf="
                                        rstMinerDataService.minerSettings.terminationCondition.getSimpleName() ===
                                        terminationTypeSimpleName
                                    "
                                    [ngSwitch]="terminationTypeSimpleName">
                                    <span
                                        *ngSwitchCase="
                                            LoopBasedTermination.SIMPLE_NAME
                                        ">
                                        <mat-form-field
                                            appearance="fill"
                                            class="full-width">
                                            <mat-label
                                                >Amount of iterations</mat-label
                                            >
                                            <input
                                                matInput
                                                min="1"
                                                placeholder="Default {{
                                                    LoopBasedTermination.DEFAULT_ITERATIONS
                                                }}"
                                                type="number"
                                                [(ngModel)]="
                                                    loopTerminationIterations
                                                " />
                                        </mat-form-field>
                                    </span>

                                    <span
                                        *ngSwitchCase="
                                            TimeBasedTermination.SIMPLE_NAME
                                        ">
                                        <mat-form-field
                                            appearance="fill"
                                            class="full-width">
                                            <mat-label>Duration</mat-label>
                                            <input
                                                matInput
                                                min="0"
                                                placeholder="Default {{
                                                    TimeBasedTermination.DEFAULT_DURATION
                                                }}"
                                                type="number"
                                                [(ngModel)]="durationAmount" />
                                        </mat-form-field>
                                        <br />
                                        <mat-form-field
                                            appearance="fill"
                                            class="full-width">
                                            <mat-label>Time Unit</mat-label>
                                            <mat-select
                                                [(value)]="durationTimeUnit">
                                                <mat-option
                                                    *ngFor="
                                                        let timeUnit of TimeBasedTermination.SUPPORTED_TIME_UNITS
                                                    "
                                                    [value]="timeUnit">
                                                    {{ timeUnit }}
                                                </mat-option>
                                            </mat-select>
                                        </mat-form-field>
                                    </span>
                                </div>
                                <br />
                            </span>
                        </div>
                    </mat-radio-group>
                </mat-expansion-panel>

                <mat-expansion-panel>
                    <mat-expansion-panel-header>
                        <mat-panel-title> Debug Mode </mat-panel-title>
                    </mat-expansion-panel-header>
                    <mat-checkbox
                        [(ngModel)]="
                            rstMinerDataService.minerSettings
                                .isDebugModusEnabled
                        ">
                        Enabled
                    </mat-checkbox>
                </mat-expansion-panel>
            </mat-accordion>
        </div>
    </mat-dialog-content>
</div>

<mat-dialog-actions align="end">
    <button
        (click)="rstMinerDataService.resetMinerSettingsToDefault()"
        [mat-dialog-close]="true"
        class="dialog-button"
        mat-button>
        Reset to Default
    </button>
    <button [mat-dialog-close]="true" class="dialog-button" mat-button>
        Apply & Close
    </button>
</mat-dialog-actions>
